<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pear Inc. - Liquid Glass Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;700&display=swap');
        
        body, html { 
            margin: 0; padding: 0; min-height: 100vh; 
            font-family: 'Segoe UI', Tahoma, sans-serif;
            overflow: hidden; /* Evita scroll para que las burbujas fluyan mejor */
            background: #00b4db;
        }

        /* FONDO FRUTIGER AERO CON IMAGEN */
        #bg-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #00b4db 0%, #00ffcc 100%);
            z-index: -3;
        }
        #bg-image {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?auto=format&fit=crop&q=80&w=2000') no-repeat center center;
            background-size: cover; opacity: 0.5; z-index: -2;
        }

        /* CANVAS PARA BURBUJAS INTERACTIVAS */
        #bubble-canvas {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 1; pointer-events: auto;
        }

        /* NAVBAR GLASSMORPHISM */
        #navbar {
            background: rgba(255, 255, 255, 0.4);
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            height: 55px; border-bottom: 2px solid rgba(255,255,255,0.6);
            display: flex; align-items: center; padding: 0 15px;
            position: relative; z-index: 1000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .apple-icon { font-size: 24px; color: #fff; cursor: pointer; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        #navbar ul { list-style: none; margin: 0 20px; padding: 0; display: flex; flex: 1; }
        #navbar li {
            flex: 1; text-align: center; line-height: 55px; color: #fff;
            font-size: 13px; font-weight: bold; cursor: pointer;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3); transition: 0.3s;
        }
        #navbar li.active { 
            background: rgba(255,255,255,0.3); border-radius: 10px;
            box-shadow: inset 0 2px 10px rgba(255,255,255,0.4);
        }

        /* CONTENEDOR PRINCIPAL */
        #main-container { 
            max-width: 500px; margin: 30px auto; 
            position: relative; z-index: 100; 
            pointer-events: none; /* Deja pasar clicks a las burbujas excepto en cajas */
        }
        
        .section { display: none; pointer-events: auto; }
        .section.active { display: block !important; }
        
        /* CAJAS ESTILO LIQUID GLASS */
        .box-ui { 
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.7);
            padding: 30px; border-radius: 25px; margin-bottom: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1), 
                        inset 0 10px 20px rgba(255,255,255,0.5);
            text-align: center; color: #fff;
            position: relative; overflow: hidden;
        }
        .box-ui::before { /* Reflejo del cristal */
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 50%;
            background: linear-gradient(to bottom, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 100%);
        }

        .count-num { 
            font-size: 70px; font-weight: bold; color: #fff; 
            text-shadow: 0 5px 15px rgba(0,180,219,0.5);
        }
        
        .tagline { 
            color: #fff; text-align: center; font-weight: bold; 
            font-size: 18px; text-shadow: 0 2px 8px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        /* BOTONES Y POPUPS */
        .btn-ui { 
            background: white; border: none; padding: 12px; border-radius: 15px; 
            font-weight: bold; color: #00b4db; cursor: pointer; width: 80%; margin: 10px auto;
        }
        #toast {
            display: none; position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%); background: rgba(255,255,255,0.95);
            padding: 30px; border-radius: 30px; z-index: 2000; text-align: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.3); width: 280px;
        }
    </style>
</head>
<body>

<div id="bg-container"></div>
<div id="bg-image"></div>
<canvas id="bubble-canvas"></canvas>

<div id="toast">
    <div id="toast-header" style="font-weight:bold; color:#00b4db; margin-bottom:15px;"></div>
    <div id="toast-body"></div>
</div>

<div id="navbar">
    <div class="apple-icon" onclick="checkMonitorClicks()"></div>
    <ul>
        <li id="tab-home" onclick="showTab('home')">Home</li>
        <li id="tab-bubbles" class="active" onclick="showTab('bubbles')">Bubbles</li>
        <li id="tab-cydia" onclick="showTab('cydia')">Cydia</li>
        <li id="tab-5d" onclick="showTab('5d')">5D</li>
    </ul>
    <div style="font-size: 20px; color: #fff; cursor: pointer;" onclick="openMainPopup()">:)</div>
</div>

<div id="main-container">
    <p class="tagline">El futuro que no prometieron</p>

    <div id="sec-home" class="section">
        <div class="box-ui">
            <h2>Pear Inc.</h2>
            <p>Diseño Liquid Glass y Memoria 5D.</p>
        </div>
    </div>

    <div id="sec-bubbles" class="section active">
        <div class="box-ui">
            <h3>Laboratorio de Burbujas</h3>
            <p style="font-size: 14px;">Interactúa con el entorno:<br>Arrástralas o hazlas explotar.</p>
        </div>
    </div>

    <div id="sec-cydia" class="section">
        <div class="box-ui">
            <p style="opacity: 0.9;">Peticiones al Servidor Cydia</p>
            <div id="contador-dinamico" class="count-num">---</div>
            <p style="font-weight: bold;">LIVE SERVER</p>
        </div>
    </div>

    <div id="sec-5d" class="section">
        <div class="box-ui">
            <h2>Memoria 5D</h2>
            <p style="font-style: italic;">"La materia es el eco de una dimensión que ya no existe."</p>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

<script>
    // --- CONFIGURACIÓN FIREBASE NICO ---
    const firebaseConfig = {
      apiKey: "AIzaSyDtV17bKSfJ_shwkRCxipRoPuxcZNL7o3k",
      authDomain: "pearserver-f8a0e.firebaseapp.com",
      databaseURL: "https://pearserver-f8a0e-default-rtdb.firebaseio.com",
      projectId: "pearserver-f8a0e",
      appId: "1:34841932085:web:96610f04b7ae4e8cca9c7c"
    };
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const serverRef = database.ref('servidor');
    const patronSuma = [44, 72, 25, 83];
    let tiempoRestante = 0;

    serverRef.on('value', (snapshot) => {
        const data = snapshot.val();
        if (data) document.getElementById('contador-dinamico').innerText = data.peticiones;
    });

    // --- LÓGICA DE PESTAÑAS ---
    function showTab(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('#navbar li').forEach(l => l.classList.remove('active'));
        document.getElementById('sec-' + id).classList.add('active');
        document.getElementById('tab-' + id).classList.add('active');
        const canvas = document.getElementById('bubble-canvas');
        canvas.style.opacity = (id === 'bubbles') ? "1" : "0.4";
    }

    // --- MOTOR DE BURBUJAS ---
    const canvas = document.getElementById('bubble-canvas');
    const ctx = canvas.getContext('2d');
    let bubbles = [];
    let mouse = { x: null, y: null, pressed: false, draggedBubble: null };

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
    });
    canvas.width = window.innerWidth; canvas.height = window.innerHeight;

    class Bubble {
        constructor() { this.reset(); }
        reset() {
            this.radius = Math.random() * 35 + 15;
            this.x = Math.random() * canvas.width;
            this.y = canvas.height + this.radius + Math.random() * 200;
            this.speedY = Math.random() * 0.8 + 0.4;
            this.speedX = Math.random() * 1 - 0.5;
            this.color = `rgba(255, 255, 255, ${Math.random() * 0.3 + 0.2})`;
        }
        update() {
            if (mouse.draggedBubble === this) {
                this.x = mouse.x; this.y = mouse.y;
            } else {
                this.y -= this.speedY; this.x += this.speedX;
                let dx = mouse.x - this.x; let dy = mouse.y - this.y;
                let dist = Math.sqrt(dx*dx + dy*dy);
                if (dist < 100 && !mouse.pressed) {
                    this.x -= dx * 0.03; this.y -= dy * 0.03;
                }
            }
            if (this.y < -this.radius) this.reset();
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fillStyle = this.color;
            ctx.fill();
            // Brillo hiperrealista
            ctx.beginPath();
            ctx.arc(this.x - this.radius/3, this.y - this.radius/3, this.radius/4, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255,255,255,0.5)';
            ctx.fill();
        }
    }

    function initBubbles() { for (let i = 0; i < 30; i++) bubbles.push(new Bubble()); }
    function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        bubbles.forEach(b => { b.update(); b.draw(); });
        requestAnimationFrame(animate);
    }

    canvas.addEventListener('mousemove', (e) => { mouse.x = e.x; mouse.y = e.y; });
    canvas.addEventListener('mousedown', (e) => {
        mouse.pressed = true;
        bubbles.forEach((b, i) => {
            let dist = Math.sqrt((e.x-b.x)**2 + (e.y-b.y)**2);
            if (dist < b.radius) {
                mouse.draggedBubble = b;
                setTimeout(() => {
                    if (!mouse.pressed) { bubbles.splice(i, 1); bubbles.push(new Bubble()); }
                }, 150);
            }
        });
    });
    canvas.addEventListener('mouseup', () => { mouse.pressed = false; mouse.draggedBubble = null; });

    // --- FUNCIONES EXTRA (MONITOR Y POPUP) ---
    function checkMonitorClicks() { /* Lógica de 3 clics para alert */ alert("Monitor Activo"); }
    function openMainPopup() {
        document.getElementById('toast-header').innerText = "Pear OS";
        document.getElementById('toast-body').innerHTML = '<button class="btn-ui" onclick="closeToast()">SALIR</button>';
        document.getElementById('toast').style.display = 'block';
    }
    function closeToast() { document.getElementById('toast').style.display = 'none'; }

    initBubbles();
    animate();
</script>
</body>
</html>
